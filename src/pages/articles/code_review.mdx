
import { ArticleLayout } from '@/components/ArticleLayout'

export const meta = {
  author: 'Yang',
  date: '2025-03-25',
  title: 'è®©DeepSeekæ¥å¸®ä½ Reviewä»£ç ',
  description:
    'GitLab, Code Review, DeepSeek, ä¼ä¸šå¾®ä¿¡ï¼ŒRobot',
}

export default (props) => <ArticleLayout meta={meta} {...props} />


é¦–å…ˆæ„Ÿè°¢å¼€æºç¤¾åŒºçš„é¡¹ç›® [CodeReview](https://github.com/mimo-x/Code-Review-GPT-Gitlab)


å®ç°ç»“æœ: 
1. é¡¹ç›®æœ‰äººæäº¤mergeä»£ç ï¼Œè§¦å‘ Gitlab hookï¼Œ
2. Gitlab æŠŠ git diff code ç»™ CodeReview serviceï¼ŒCodeReview service æŠŠgit diff äº¤ç»™Ollama éƒ¨ç½²çš„DeepSeekå¤„ç†ï¼ŒDeepSeekæŠŠAI review code è¿”å›ç»™ CodeReview service
3. Pythonæ”¶åˆ°AI reviewï¼Œè°ƒç”¨ä¼ä¸šå¾®ä¿¡Robotï¼Œä¼ä¸šå¾®ä¿¡RobotæŠŠAI Reviewç»“æœï¼Œå‘é€åˆ°èŠå¤©ç¾¤

![code_robot](/images/tech/code_robot.png)



### ä¸€ã€ç”¨Rootè´¦å·ï¼Œåˆ›å»ºé¡¹ç›®çš„webhook

![webhook](/images/tech/webhook.png)


### äºŒã€Clone `https://github.com/mimo-x/Code-Review-GPT-Gitlab` ä»£ç ï¼Œå¹¶è¿è¡Œèµ·æ¥

* æˆ‘åœ¨Ubuntu 24æœºå™¨ä¸Šè¿è¡Œçš„ python3

```
  åœ¨é¡¹ç›®ç›®å½•ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒï¼š

  python -m venv venv

  æ ¹æ®ä½ çš„æ“ä½œç³»ç»Ÿï¼Œæ¿€æ´»è™šæ‹Ÿç¯å¢ƒï¼š

  source venv/bin/activate

  åœ¨è™šæ‹Ÿç¯å¢ƒä¸­è¿è¡Œï¼š

  pip install -r requirements.txt

  é€€å‡ºè™šæ‹Ÿç¯å¢ƒ

  deactivate

```

* åå°è¿è¡Œ app.py
```
  ä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‡ ç§æ–¹å¼è®© python3 ./app.py åœ¨åå°è¿è¡Œï¼š

  â¸»

  1. ä½¿ç”¨ nohupï¼ˆæ¨èï¼‰

  nohup python3 ./app.py > output.log 2>&1 &

    â€¢	nohupï¼šå¿½ç•¥æŒ‚èµ·ä¿¡å·ï¼Œå³ä½¿ä½ å…³é—­ç»ˆç«¯ï¼Œè¿›ç¨‹ä¹Ÿä¸ä¼šé€€å‡ºã€‚
    â€¢	> output.log 2>&1ï¼šå°†æ ‡å‡†è¾“å‡ºå’Œé”™è¯¯è¾“å‡ºé‡å®šå‘åˆ° output.logï¼Œé˜²æ­¢è¿›ç¨‹å›  I/O é—®é¢˜è¢«ç»ˆæ­¢ã€‚
    â€¢	&ï¼šè®©è¿›ç¨‹åœ¨åå°è¿è¡Œã€‚

  æŸ¥çœ‹è¿è¡Œä¸­çš„è¿›ç¨‹ï¼š

  ps aux | grep app.py

  åœæ­¢è¿›ç¨‹ï¼š

  kill <è¿›ç¨‹ID>

```

### æ·»åŠ ä¼ä¸šå¾®ä¿¡robotå‘é€ä¿¡æ¯

ç”±äºè¿™ä¸ªå¼€æºé¡¹ç›® åªæœ‰é’‰é’‰çš„robotæ¶ˆæ¯ï¼Œä½†æ˜¯æˆ‘ä»¬å…¬å¸ç”¨ä¼ä¸šå¾®ä¿¡ï¼Œéœ€è¦è‡ªå·±é­”æ”¹ï¼ŒæŠŠä¼ä¸šå¾®ä¿¡çš„robotå¡«è¿›å»ï¼Œæ­£å¥½ä¹‹å‰è‡ªå·±åšäº†ä¸€ä¸ª Jenkinsæ‰“åŒ…é€šçŸ¥ ä¼ä¸šå¾®ä¿¡robotï¼Œè¿™æ¬¡å¯ä»¥ç›´æ¥æ‹¿æ¥ç”¨

* åˆ›å»ºä¼ä¸šå¾®ä¿¡robot
![create_wechat_rebot](/images/tech/create_wechat_rebot.png)

åˆ›å»ºæˆåŠŸåï¼Œä¼ä¸šå¾®ä¿¡ä¼šç»™ä½ ä¸€ä¸ª WECHAT_URL

```
import requests
from config.config import *

from response_module.abstract_response import AbstractResponseMessage

class WechatResponse(AbstractResponseMessage):
    def __init__(self, config):
        super().__init__(config)

    def send(self, message):
        # è¿™é‡Œå®ç°å‘é€æ¶ˆæ¯åˆ° Slack çš„é€»è¾‘
        
        WEBHOOK_URL = WECHAT_URL

        message = {
        "msgtype": "text",
        "text": {
            # "mentioned_list": ["@all"],
            "content": message
        }
        }

        response = requests.post(WEBHOOK_URL, json=message)
        if response.status_code == 200:
            print("WeChat æ¶ˆæ¯å‘é€æˆåŠŸ")
        else:
            print(f"WeChat æ¶ˆæ¯å‘é€å¤±è´¥: {response.status_code} - {response.text}")
        return True
```



### è¿è¡ŒæˆåŠŸ

å®Œç¾ğŸ˜



